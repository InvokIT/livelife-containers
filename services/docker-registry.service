[Unit]
Description=Private Docker Registry
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
ExecStartPre=-/usr/bin/docker kill docker-registry
ExecStartPre=-/usr/bin/docker rm docker-registry
ExecStartPre=/usr/bin/docker pull registry:2
ExecStart=/usr/bin/docker run --name docker-registry -v /shared/docker-registry:/var/lib/registry -p 5000:5000 registry:2
ExecStop=/usr/bin/docker stop docker-registry